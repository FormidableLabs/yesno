language: node_js

node_js:
  - "6"
  - "8"
  - "10"

branches:
  only:
    - master

install:
  # Fail if lockfile outdated.
  # https://yarnpkg.com/lang/en/docs/cli/install/#toc-yarn-install-frozen-lockfile
  - yarn install --frozen-lockfile

script:
  - yarn --version
  - yarn run clean
  - yarn run compile
  - yarn run lint

  - >
    node_version=$(node -v);
    if [ ${node_version:1:1} > 6 ]; then
      yarn run tests
    fi
  # TODO: Add coverage
  # https://github.com/FormidableLabs/yesno/issues/5

after_success:
  - yarn run codecov
